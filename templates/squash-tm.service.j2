[Unit]
Description=SquashTM Community Edition
After=network.target mariadb.service
Requires=mariadb.service

[Service]
Type=forking
User=squash-tm
Group=squash-tm
WorkingDirectory={{ install_dir }}
ExecStart={{ install_dir }}/bin/startup.sh
ExecStop={{ install_dir }}/bin/shutdown.sh
Restart=on-failure
RestartSec=10s

# Security hardening
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths={{ install_dir }}

[Install]
WantedBy=multi-user.target
